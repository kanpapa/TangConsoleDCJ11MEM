# 2.9BSD
- CPUタイプが70と認識されるのですが、それだとbootしてくれませんでした。CPUタイプを40とすればbootしたのでそれで対処しました。
## ディストリビューションテープからのインストール
- [https://www.tuhs.org/Archive/Distributions/UCB/2.9BSD/](https://www.tuhs.org/Archive/Distributions/UCB/2.9BSD/)にあるfile?.gz と usr.tar.gz をgunzipして，下記の配置でsdメモリに書き込み，PmodのSDメモリに搭載します．
```
dd if=file1 of=29bsdtape.dsk
dd if=file2 of=29bsdtape.dsk seek=65536 conv=notrunc
dd if=file3 of=29bsdtape.dsk seek=131072 conv=notrunc
dd if=file4 of=29bsdtape.dsk seek=196608 conv=notrunc
dd if=file5 of=29bsdtape.dsk seek=262144 conv=notrunc
dd if=file6 of=29bsdtape.dsk seek=327680 conv=notrunc
dd if=file7 of=29bsdtape.dsk seek=393216 conv=notrunc
dd if=usr.tar of=29bsdtape.dsk seek=458752 conv=notrunc

dd if=29bsdtape.dsk of=/dev/xxx
```
- Tang Consoleには空のSDメモリ(HDD用)を搭載します．
- https://www.tuhs.org/Archive/Distributions/UCB/Documentation/2.9bsd_setup.html の手順に従ってインストールします．
- 100040gで777570(switch register)に40を書き込みます。(ODTで手動で書き込んでもOK。)
- rom.vにより，100000番地以降にテープ用のブートローダーが書かれているのでODTで100000gで0番地に読み込まれます．これを0gで実行します．
```
@100040g
100050
@777570/000040 
@100000g
100014
@0
40Boot
: tm(0,3)
Mkfs
file system: rp(0,0)
file sys size: 5200
interleaving factor (m; 5 default): 
interleaving modulus (n; 10 default): 
isize = 3328
m/n = 5 10
Exit called

40Boot
: tm(0,4)
Restor
Tape? tm(0,6)
Disk? rp(0,0)
Last chance before scribbling on disk. 
End of tape
*** 数分かかる ***
40Boot
: rp(0,0)rpunix

Berkeley UNIX (Rev. 2.9.1) Sun Nov 20 14:55:50 PST 1983
mem = 135872

CONFIGURE SYSTEM:
xp ? csr 176700 vector 254 interrupt vector already in use
rk 0 csr 177400 vector 220 attached
hk ? csr 177440 vector 210 didn't interrupt
rl ? csr 174400 vector 160 didn't interrupt
rp ? csr 176700 vector 254 didn't interrupt
ht 0 csr 172440 vector 224 skipped:  No CSR
tm 0 csr 172520 vector 224 attached
ts 0 csr 172520 vector 224 interrupt vector already in use
dh ? csr 160020 vector 370 skipped:  No CSR
dm ? csr 170500 vector 360 skipped:  No autoconfig routines
dz ? csr 160110 vector 320 didn't interrupt
dz ? csr 160110 vector 320 didn't interrupt
dn 0 csr 175200 vector 300 skipped:  No autoconfig routines
vp ? csr 177500 vector 174 skipped:  No autoconfig routines
lp ? csr 177514 vector 200 didn't interrupt
Erase=^?, kill=^U, intr=^C
# dd if=/mdec/rpuboot of=/dev/rrp0a count=1
0+1 records in
0+1 records out
# cd /dev
# ./MAKE tm0
# ./MAKE rp1a rp1b rp1c rp1h
# ls rp*
rp0a  rp0b  rp0c  rp0h  rp1a  rp1b  rp1c  rp1h
# ls rrp*
rrp0a  rrp0b  rrp0c  rrp0h  rrp1a  rrp1b  rrp1c  rrp1h
# /etc/mkfs /dev/rrp1h 41590
isize = 26608
m/n = 5 10
# fsck /dev/rp0a

/dev/rp0a
File System: /

** Checking /dev/rp0a
** Phase 1 - Check Blocks and Sizes
** Phase 2 - Check Pathnames
** Phase 3 - Check Connectivity
** Phase 4 - Check Reference Counts
** Phase 5 - Check Free List 
250 files 1916 blocks 3074 free
# fsck /dev/rp1h

/dev/rp1h
File System: 


NEED SCRATCH FILE (65 BLKS)
ENTER FILENAME:  hoge
** Checking /dev/rp1h
** Phase 1 - Check Blocks and Sizes
** Phase 2 - Check Pathnames
** Phase 3 - Check Connectivity
** Phase 4 - Check Reference Counts
** Phase 5 - Check Free List 
3 files 6 blocks 39919 free
# /etc/mount /dev/rp1h /usr
# cd /usr
# df .
Filesystem  Mounted on  kbytes    used    free  % used
/dev/rp1h   /usr         39925       6   39919      0%
# mt -t /dev/nrmt0 fsf 7
# tar xvpf /dev/rmt0
Tar: blocksize = 20
x ./70/adb, 28204 bytes, 56 tape blocks
x ./70/make, 18182 bytes, 36 tape blocks
x ./70/dump, 9806 bytes, 20 tape blocks

*** 1時間ぐらいかかる ***

x ./ingres/version, 92 bytes, 1 tape blocks
x ./ingres/.cshrc, 64 bytes, 1 tape blocks
x ./ingres/.login, 158 bytes, 1 tape blocks
x ./ingres/.exrc, 27 bytes, 1 tape blocks
# ls
70          dict        ingres      man         public      tmp
adm         doc         lib         msgs        spool       ucb
bin         games       local       net         src
contrib     include     lost+found  preserve    sys
# ls bin
512dumpdir  dc          look        prep        sh          uuencode
512restor   delrem      lookbib     prfile      spell       uulog
Mail        deroff      lorder      primes      split       uuname
ac          diff3       ls          printenv    struct      uusend
at          dumpdir     m4          prof        sum         uusnap
awk         egrep       mesg        ptx         sync        uustat
basename    enroll      mkdir       px          tabs        uux
bc          eqn         neqn        pxp         tbl         why
cal         f77         nohup       quot        tp          write
calendar    factor      nroff       ratfor      tr          xget
cb          find        ovadb       refer       troff       xsend
checkeq     join        pcc         remind      tsort       yacc
checkobj    learn       pi          restor      tty
col         lex         pix         rev         unifdef
comm        lint        plot        sa          uniq
crypt       login       pr          sed         uudecode
```